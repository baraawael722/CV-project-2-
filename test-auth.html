<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Authentication</title>
    <style>
        * {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 500px;
            width: 100%;
        }

        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 30px;
        }

        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        h2 {
            color: #333;
            font-size: 20px;
            margin-bottom: 15px;
        }

        input {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            box-sizing: border-box;
        }

        input:focus {
            border-color: #667eea;
            outline: none;
        }

        button {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
            transition: transform 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        .result {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            font-size: 14px;
            word-break: break-all;
        }

        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        select {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            background: white;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-right: 5px;
        }

        .badge-success {
            background: #28a745;
            color: white;
        }

        .badge-error {
            background: #dc3545;
            color: white;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ğŸ” Ø§Ø®ØªØ¨Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„</h1>

        <!-- Registration Section -->
        <div class="section">
            <h2>ğŸ“ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ (Register)</h2>
            <input type="text" id="regName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" value="Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯">
            <input type="email" id="regEmail" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" value="mohamed@test.com">
            <input type="password" id="regPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" value="mohamed123">
            <select id="regRole">
                <option value="employee">Employee (Ù…ÙˆØ¸Ù)</option>
                <option value="hr">HR (Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ©)</option>
            </select>
            <button onclick="testRegister()">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</button>
            <div id="regResult"></div>
        </div>

        <!-- Login Section -->
        <div class="section">
            <h2>ğŸ”“ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ (Login)</h2>
            <input type="email" id="loginEmail" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" value="fatma@test.com">
            <input type="password" id="loginPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" value="fatma1234">
            <select id="loginRole">
                <option value="employee">Employee (Ù…ÙˆØ¸Ù)</option>
                <option value="hr">HR (Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ©)</option>
            </select>
            <button onclick="testLogin()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
            <div id="loginResult"></div>
        </div>

        <!-- Check Storage Section -->
        <div class="section">
            <h2>ğŸ’¾ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©</h2>
            <button onclick="checkStorage()">Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©</button>
            <button onclick="clearStorage()" style="background: #dc3545;">Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
            <div id="storageResult"></div>
        </div>
    </div>

    <script>
        const API_URL = 'http://localhost:5000/api/auth';

        async function testRegister() {
            const name = document.getElementById('regName').value;
            const email = document.getElementById('regEmail').value;
            const password = document.getElementById('regPassword').value;
            const role = document.getElementById('regRole').value;
            const resultDiv = document.getElementById('regResult');

            try {
                resultDiv.innerHTML = '<div class="result info">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„...</div>';

                const response = await fetch(`${API_URL}/register`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, email, password, role })
                });

                const data = await response.json();

                if (response.ok) {
                    localStorage.setItem('token', data.token);
                    localStorage.setItem('user', JSON.stringify(data.user));

                    resultDiv.innerHTML = `
                        <div class="result success">
                            <span class="status-badge badge-success">âœ“ Ù†Ø¬Ø­</span>
                            <strong>ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!</strong><br>
                            <strong>Ø§Ù„Ø§Ø³Ù…:</strong> ${data.user.name}<br>
                            <strong>Ø§Ù„Ø¨Ø±ÙŠØ¯:</strong> ${data.user.email}<br>
                            <strong>Ø§Ù„Ø¯ÙˆØ±:</strong> ${data.user.role}<br>
                            <strong>Token:</strong> ${data.token.substring(0, 40)}...
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div class="result error">
                            <span class="status-badge badge-error">âœ— ÙØ´Ù„</span>
                            <strong>Ø®Ø·Ø£:</strong> ${data.message}
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="result error">
                        <span class="status-badge badge-error">âœ— Ø®Ø·Ø£ Ø´Ø¨ÙƒØ©</span>
                        <strong>Ø®Ø·Ø£:</strong> ${error.message}<br>
                        ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù€ Backend Ø´ØºØ§Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ÙØ° 5000
                    </div>
                `;
            }
        }

        async function testLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const role = document.getElementById('loginRole').value;
            const resultDiv = document.getElementById('loginResult');

            try {
                resultDiv.innerHTML = '<div class="result info">â³ Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...</div>';

                const response = await fetch(`${API_URL}/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password, role })
                });

                const data = await response.json();

                if (response.ok) {
                    localStorage.setItem('token', data.token);
                    localStorage.setItem('user', JSON.stringify(data.user));

                    resultDiv.innerHTML = `
                        <div class="result success">
                            <span class="status-badge badge-success">âœ“ Ù†Ø¬Ø­</span>
                            <strong>ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­!</strong><br>
                            <strong>Ø§Ù„Ø§Ø³Ù…:</strong> ${data.user.name}<br>
                            <strong>Ø§Ù„Ø¨Ø±ÙŠØ¯:</strong> ${data.user.email}<br>
                            <strong>Ø§Ù„Ø¯ÙˆØ±:</strong> ${data.user.role}<br>
                            <strong>Token:</strong> ${data.token.substring(0, 40)}...
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div class="result error">
                            <span class="status-badge badge-error">âœ— ÙØ´Ù„</span>
                            <strong>Ø®Ø·Ø£:</strong> ${data.message}
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="result error">
                        <span class="status-badge badge-error">âœ— Ø®Ø·Ø£ Ø´Ø¨ÙƒØ©</span>
                        <strong>Ø®Ø·Ø£:</strong> ${error.message}<br>
                        ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù€ Backend Ø´ØºØ§Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ÙØ° 5000
                    </div>
                `;
            }
        }

        function checkStorage() {
            const token = localStorage.getItem('token');
            const user = localStorage.getItem('user');
            const resultDiv = document.getElementById('storageResult');

            if (token && user) {
                const userData = JSON.parse(user);
                resultDiv.innerHTML = `
                    <div class="result success">
                        <span class="status-badge badge-success">âœ“ Ù…Ø­ÙÙˆØ¸</span>
                        <strong>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ:</strong><br>
                        <strong>Ø§Ù„Ø§Ø³Ù…:</strong> ${userData.name}<br>
                        <strong>Ø§Ù„Ø¨Ø±ÙŠØ¯:</strong> ${userData.email}<br>
                        <strong>Ø§Ù„Ø¯ÙˆØ±:</strong> ${userData.role}<br>
                        <strong>Token:</strong> ${token.substring(0, 40)}...
                    </div>
                `;
            } else {
                resultDiv.innerHTML = `
                    <div class="result info">
                        <strong>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©</strong><br>
                        Ù‚Ù… Ø¨ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹
                    </div>
                `;
            }
        }

        function clearStorage() {
            localStorage.removeItem('token');
            localStorage.removeItem('user');
            document.getElementById('storageResult').innerHTML = `
                <div class="result success">
                    <span class="status-badge badge-success">âœ“ ØªÙ…</span>
                    ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
                </div>
            `;
        }

        // Auto-check storage on page load
        window.onload = checkStorage;
    </script>
</body>

</html>